<spring:beans xmlns="http://membrane-soa.org/proxies/1/"
			  xmlns:spring="http://www.springframework.org/schema/beans"
			  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
			  xsi:schemaLocation="http://www.springframework.org/schema/beans
	http://www.springframework.org/schema/beans/spring-beans-4.2.xsd
	http://membrane-soa.org/proxies/1/ http://membrane-soa.org/schemas/proxies-1.xsd">

	<router>
		<serviceProxy name="Token Validator" port="2002">

			<!-- Validates tokens against authorization server - blocks request on invalid token -->
			<tokenValidator endpoint="http://localhost:2000/oauth2/userinfo"/>

			<!-- Routes to protected resource on valid token -->
			<target host="localhost" port="2003"/>

		</serviceProxy>

		<!-- Protected resource -->
		<serviceProxy port="2003">
			<groovy>
				exc.response(Reponse.ok().build())
			</groovy>
		</serviceProxy>

		<serviceProxy port="9002">
			<adminConsole/>
		</serviceProxy>
	</router>

</spring:beans>
